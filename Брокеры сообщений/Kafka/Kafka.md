***Apache Kafka*** — это распределённая потоковая платформа с открытым исходным кодом, изначально разработанная в ***LinkedIn*** и переданная в *Apache Software Foundation*. Её основное назначение — обработка, хранение и передача потоков данных в реальном времени.

## Как устрокена?
1. **Топики** (Topics)
- Данные в Kafka организованы в «топики» (темы) — что-то вроде каналов, куда можно писать и откуда можно читать сообщения.
2. **Продюсеры (Producers)**  
- Это клиенты, которые публикуют сообщения в топики
3. **Брокеры (Brokers)**  
- Серверы Kafka, которые хранят данные и обрабатывают запросы от продюсеров и консумеров. Обычно разворачивается кластер из нескольких брокеров для отказоустойчивости.
4. **Партиции** (Partitions)
- Каждый топик разбивается на партиции — это позволяет распределять нагрузку и параллельно обрабатывать данные. 
5. **Консьюмеры** (Consumers)
- Клиенты, которые читают данные из топиков. Консьюмеры объединяются в группы для балансировки нагрузки.
6. **Zookeeper (устар.) / KRaft (новый контроллер)**
- Раньше Kafka использовала Zookeeper для координации кластера, но начиная с новых версий переходит на **KRaft** (встроенный консенсус-механизм). 

## Как работает Kafka
- Продюсер отправляет сообщение в **топик**.
- Сообщение записывается в **партицию** внутри топика и хранится в лог-файле.
- Kafka гарантирует порядок сообщений **внутри одной партиции**.
- Консьюмеры читают данные, Kafka отслеживает смещения (offset) — где именно консьюмер остановился.
- Kafka может хранить данные долго (недели и месяцы), а не просто пересылать.

## Основные преимущества

- **Высокая производительность** — миллионы сообщений в секунду.
- **Масштабируемость** — легко добавлять новые брокеры.
- **Надёжность** — данные реплицируются между брокерами.
- **Гибкость** — можно использовать и для очередей сообщений, и для потоковой аналитики.

## Пример
![[kafka.png]]

На картинке показана упрощённая архитектура Apache Kafka и то, как данные двигаются:
- **Producer (слева)** — источник данных. Он отправляет сообщения (events, records) в Kafka.
- **Brokers (в центре)** — это серверы Kafka, которые принимают сообщения от продюсеров и хранят их. Каждый брокер содержит **Partitions** (партиции).
    - Партиции делят топик на части, чтобы можно было обрабатывать данные параллельно.
    - Внутри партиции сообщения хранятся в порядке поступления (append-only log).
- **Consumer (справа)** — приложение или сервис, который читает сообщения из Kafka.
- **Потоки сообщений (стрелки)** — показывают, что данные идут от продюсера к брокерам (в партиции), а затем — к консюмеру.