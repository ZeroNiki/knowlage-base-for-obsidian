# Первое видео
## _Как работает интернет_
Когда я перехожу на сайт youtube.com, происходит несколько ключевых шагов:

1. **Запрос к серверу:** Мой браузер отправляет запрос на сервер YouTube, чтобы получить веб-страницу. Этот запрос включает информацию о том, что я хочу видеть.

2. **Разрешение домена:** Доменное имя "youtube.com" преобразуется в IP-адрес через систему доменных имен (DNS). Это как нахождение адреса компании по ее названию.

3. **Получение данных:** Сервер YouTube обрабатывает запрос и отправляет обратно все необходимые данные — HTML-код страницы, CSS для оформления, JavaScript для интерактивности, а также изображения и другие ресурсы.

4. **Отображение страницы:** Мой браузер получает эти данные и начинает их обрабатывать. Он отображает структуру страницы, применяет стили и запускает скрипты, чтобы страница работала как задумано.

5. **Загрузка и воспроизведение видео:** Если я выбираю видео для просмотра, браузер отправляет запрос на серверы, где хранятся видеоролики. Видео начинает загружаться и воспроизводиться в браузере.

В результате, я вижу главную страницу YouTube с видео, рекомендованными роликами и другими элементами, с которыми могу взаимодействовать.

## _Как браузер формирует запросы_
Когда я ввожу URL в адресной строке браузера или нажимаю на ссылку, браузер формирует запрос к серверу следующим образом:

1. **Разрешение домена:** Браузер использует DNS, чтобы преобразовать доменное имя (например, `youtube.com`) в IP-адрес сервера, на котором находится сайт. Это похоже на поиск адреса по имени компании.

2. **Формирование запроса:** Браузер создает запрос в формате HTTP или HTTPS. В этом запросе указывается, что именно нужно от сервера (например, главная страница, изображение или видео). Запрос включает:
   - **Метод запроса:** Например, `GET` для получения данных или `POST` для отправки данных на сервер.
   - **URL-адрес:** Это путь к ресурсу на сервере (например, `/home`).
   - **Заголовки:** Дополнительная информация, такая как тип браузера или язык.
   - **Тело запроса (если нужно):** Например, данные формы при использовании `POST`.

3. **Отправка запроса:** Браузер отправляет этот запрос на сервер по указанному IP-адресу.

4. **Получение ответа:** Сервер обрабатывает запрос и отправляет обратно данные, которые браузер должен показать. Это может быть HTML-код, CSS, JavaScript или другие файлы.

5. **Отображение данных:** Браузер получает ответ от сервера и отображает содержимое веб-страницы. Он обрабатывает HTML, применяет CSS для стилей и выполняет JavaScript для интерактивности.

## _Как передать файл_
Чтобы передать файл через интернет, используются следующие шаги:

1. **Выбор файла:** Пользователь выбирает файл на своем компьютере, который он хочет передать.

2. **Формирование запроса:** При передаче файла (например, через веб-форму) браузер формирует HTTP-запрос с использованием метода `POST`. В этом запросе файл включается в тело запроса. Обычно используется специальный формат, такой как `multipart/form-data`, чтобы отправить файл и другие данные в одном запросе.

3. **Отправка файла:** Браузер отправляет запрос на сервер, включая файл в качестве части данных. Запрос направляется на URL-адрес сервера, который обрабатывает загрузку файлов.

4. **Обработка на сервере:** Сервер получает запрос и извлекает файл из тела запроса. Он может сохранять файл на сервере или обрабатывать его по мере необходимости (например, сохранять в базу данных или отправлять по электронной почте).

5. **Подтверждение:** После обработки файла сервер может отправить ответ браузеру с подтверждением успешной загрузки или с информацией об ошибке.

## _Как добавить банковскую танзакцию._
Чтобы добавить банковскую транзакцию в систему, следует выполнить следующие шаги:

1. **Сбор данных:** Сначала нужно собрать все необходимые данные для транзакции. Это включает в себя информацию о счете отправителя, счете получателя, сумму транзакции и, возможно, дополнительную информацию, такую как описание или идентификатор транзакции.

2. **Валидация данных:** Прежде чем транзакция будет добавлена в систему, нужно проверить правильность и полноту данных. Это может включать в себя проверку наличия достаточных средств, правильность реквизитов счетов и отсутствие ошибок.

3. **Формирование запроса:** Создается запрос для добавления транзакции в систему. В банковских системах это может быть запрос к базе данных или вызов API. Запрос содержит все данные о транзакции, такие как сумма, счет отправителя и счет получателя.

4. **Отправка запроса:** Запрос отправляется на сервер банковской системы, который обрабатывает транзакции. В случае веб-приложений это может быть HTTP-запрос через API.

5. **Обработка транзакции:** Сервер или банковская система обрабатывает запрос. Это может включать проверку на мошенничество, обновление балансов счетов и регистрацию транзакции в базе данных.

6. **Подтверждение:** После успешной обработки транзакции система отправляет подтверждение о том, что транзакция была выполнена успешно. Это может быть сообщение в интерфейсе пользователя или уведомление по электронной почте.

7. **Запись и отчет:** Транзакция записывается в журнал операций и отчетность для последующего аудита и анализа.

Чтобы безопасно добавить банковскую транзакцию, нужно учитывать несколько ключевых аспектов безопасности:

---
для безопасности

1. **Шифрование данных:**
   - **Шифрование на уровне передачи:** Используйте SSL/TLS для шифрования данных, передаваемых между клиентом и сервером, чтобы предотвратить перехват и подделку информации.
   - **Шифрование на уровне хранения:** Храните чувствительные данные, такие как реквизиты счетов и информация о транзакциях, в зашифрованном виде в базе данных.

2. **Аутентификация и авторизация:**
   - **Аутентификация:** Убедитесь, что только авторизованные пользователи могут инициировать транзакции. Это может включать использование многократной аутентификации (например, двухфакторная аутентификация).
   - **Авторизация:** Проверьте, что пользователи имеют соответствующие права доступа для выполнения транзакций. Например, только владельцы счетов или уполномоченные лица могут проводить операции.

3. **Валидация и проверка данных:**
   - **Валидация ввода:** Проверьте все вводимые данные на корректность и полноту до того, как они будут отправлены на сервер. Это помогает предотвратить атаки типа SQL-инъекций или других манипуляций с данными.
   - **Проверка достаточности средств:** Убедитесь, что на счете отправителя достаточно средств для выполнения транзакции.

4. **Мониторинг и аудит:**
   - **Логирование:** Ведите журнал всех транзакций и действий пользователей. Это позволяет отслеживать подозрительную активность и проводить расследования при необходимости.
   - **Аудит:** Регулярно проводите аудиты безопасности для обнаружения уязвимостей и обеспечения соответствия стандартам безопасности.

5. **Обработка ошибок:**
   - **Безопасные сообщения об ошибках:** Не раскрывайте избыточную информацию в сообщениях об ошибках, чтобы не предоставить потенциальным злоумышленникам детали о внутренней структуре системы.

6. **Обновления и патчи:**
   - **Обновление программного обеспечения:** Регулярно обновляйте ваше программное обеспечение и систему безопасности, чтобы защититься от известных уязвимостей.

---

Эти меры помогут обеспечить безопасность транзакций, минимизируя риски утечек данных, мошенничества и других угроз.

## _Что возращяет сервер_
Когда клиент (например, веб-браузер или мобильное приложение) отправляет запрос на сервер, сервер возвращает ответ, который обычно состоит из нескольких частей:

1. **Код состояния:** Это числовой код, который сообщает клиенту о результате обработки запроса. Например, код `200` означает успешное выполнение запроса, `404` указывает на то, что запрашиваемая страница не найдена, а `500` сигнализирует о внутренней ошибке сервера.

2. **Заголовки:** Заголовки содержат метаданные о ответе, такие как тип содержимого (`Content-Type`), дата и время ответа (`Date`), информация о кэшировании (`Cache-Control`), и другие параметры. Заголовки помогают клиенту правильно интерпретировать полученные данные.

3. **Тело ответа:** Это основная часть ответа, которая содержит данные, запрашиваемые клиентом. В зависимости от типа запроса и ответов это могут быть:
   - **HTML-страницы:** Для веб-страниц.
   - **JSON или XML:** Для данных, возвращаемых API.
   - **Изображения, видео или другие файлы:** В случае загрузки мультимедиа.

4. **Статус сообщения:** В некоторых случаях может включать текстовое сообщение, поясняющее статус ответа. Например, вместе с кодом состояния `200 OK` может быть сообщение "Request was successful."

## _Вопрос со *_
Для обеспечения безопасности при передаче данных между сервисами, где необходимо подтвердить подлинность данных, но при этом не позволять сторонним сервисам их изменять или подделывать, вы можете использовать подходы, такие как подписи данных и использование токенов

---

Если мы хотим передавать данные о клиенте в другой сервис и обеспечить, чтобы этот сервис мог проверять подпись, но не мог изменять токены, мы можем использовать следующий подход:

1. **Создание подписанного токена:**
   - **Подпись данных:** При создании токена, мы подписываем данные с помощью секрета или закрытого ключа. Это делается с использованием криптографической функции, такой как HMAC (Hash-based Message Authentication Code) или цифровой подписи с помощью RSA или ECDSA.
   - **Формирование токена:** Токен состоит из данных (например, информации о клиенте) и подписи. Подпись подтверждает, что данные не были изменены после их создания.

2. **Передача токена:** Мы передаем этот подписанный токен в другой сервис. Этот токен включает как данные, так и подпись.

3. **Проверка подписи:** В целевом сервисе:
   - **Верификация подписи:** Сервис использует секретный ключ или открытый ключ для проверки подписи токена. Это позволяет убедиться, что токен не был изменен.
   - **Извлечение данных:** После успешной проверки подписи, сервис извлекает данные из токена.

4. **Ограничение возможности изменения токенов:** Поскольку подпись основывается на секрете или закрытом ключе, и эти ключи хранятся только у нас (или в защищенном месте), другие сервисы не могут создавать или изменять токены без доступа к этому секрету.

Таким образом, мы гарантируем, что другие сервисы могут проверить подлинность данных, но не могут изменять токены или создавать поддельные токены.

## _Зачем нужна пара access и refresh токены_
Пара токенов — access и refresh токены — используется для управления доступом и безопасности:

- **Access Token:** Дает доступ к ресурсам и имеет короткий срок действия. Он передается с запросами и проверяется сервером.

- **Refresh Token:** Используется для получения нового access токена, когда старый истекает. Имеет долгий срок действия и хранится в безопасном месте.

**Почему пара токенов?** Это обеспечивает безопасность (короткий срок действия access токенов) и удобство (безопасное обновление access токенов с помощью refresh токенов).

## _JWT или сессии — что лучше?_
**JWT (JSON Web Tokens):**
- **Плюсы:** Легко масштабировать, хранится на клиенте, подходит для распределенных систем.
- **Минусы:** Токены могут быть скомпрометированы, сложнее отозвать.

**Сессии:**
- **Плюсы:** Управление на сервере, легко отозвать или обновить.
- **Минусы:** Требует хранения состояния на сервере, может усложнить масштабирование.

**Выбор:**
- **JWT** — если нужна масштабируемость и клиентская аутентификация.
- **Сессии** — если важен контроль на сервере и возможность быстрого отзыва.

### _Проектирование системы авторизации_

**1. Требования:**
- **Аутентификация пользователей:** Проверка подлинности пользователей.
- **Авторизация:** Управление доступом к различным ресурсам на основе ролей и прав.
- **Безопасность:** Защита данных и предотвращение несанкционированного доступа.

**2. Компоненты системы:**

- **Регистрация и аутентификация:**
  - **Регистрация:** Пользователи создают учетные записи, предоставляя свои данные (например, электронную почту и пароль). Пароли хранятся в зашифрованном виде.
  - **Аутентификация:** При входе пользователи вводят учетные данные. Система проверяет их и создает **JWT (JSON Web Token)** или **сессию**.

- **JWT (если выбран):**
  - **Создание токена:** После успешной аутентификации создается JWT, содержащий информацию о пользователе и его правах. Токен подписан для предотвращения подделки.
  - **Хранение:** JWT хранится на клиенте (например, в localStorage или в HTTP-Only cookie).
  - **Проверка:** При каждом запросе клиент отправляет токен, который сервер проверяет. Если токен действителен, доступ предоставляется.

- **Сессии (если выбран):**
  - **Создание сессии:** После аутентификации создается запись сессии на сервере, ассоциированная с пользователем. Клиент получает идентификатор сессии.
  - **Хранение:** Идентификатор сессии хранится в cookie (HTTP-Only для безопасности).
  - **Проверка:** При каждом запросе клиент отправляет идентификатор сессии, который сервер проверяет. Если сессия действительна, доступ предоставляется.

- **Авторизация:**
  - **Роли и права:** Система управляет ролями (например, администратор, пользователь) и правами доступа. Информация о ролях может быть включена в JWT или храниться в базе данных.
  - **Контроль доступа:** На основе ролей и прав система ограничивает доступ к различным ресурсам и функциональности.

- **Безопасность:**
  - **Шифрование:** Используйте HTTPS для защиты данных, передаваемых между клиентом и сервером.
  - **Обновление токенов:** Используйте refresh токены для обновления access токенов и продления сеанса без повторного входа.
  - **Обработка ошибок:** Обеспечьте правильное управление ошибками и защите от возможных атак, таких как XSS и CSRF.

## _Как улучшить Dockerfile_
### **1. Используйте Упрощенные Образцы**

- **Минимизация образа:** Используйте легкие базовые образы, такие как `alpine` или `scratch`, если это возможно. Это помогает уменьшить размер конечного образа и повысить безопасность.

  ```Dockerfile
  FROM node:alpine
  ```

### **2. Оптимизация Слоев**

- **Минимизируйте количество слоев:** Старайтесь объединять команды `RUN` в один слой, чтобы уменьшить количество слоев и размер конечного образа.

  ```Dockerfile
  RUN apk update && apk add --no-cache \
      package1 \
      package2
  ```

### **3. Используйте Кеширование**

- **Упорядочите команды:** Расположите часто меняющиеся команды в конце Dockerfile, чтобы использовать кэш Docker и избежать повторного выполнения команд, которые редко изменяются.

  ```Dockerfile
  COPY package.json /app/
  RUN npm install
  COPY . /app/
  ```

### **4. Устранение Безопасных Рисков**

- **Используйте не привилегированные пользователи:** Не запускайте контейнеры от пользователя `root` для повышения безопасности.

  ```Dockerfile
  USER nobody
  ```

### **5. Обновление и Очистка**

- **Удаляйте временные файлы:** После установки пакетов или выполнения команд, которые создают временные файлы, очищайте их для уменьшения размера образа.

  ```Dockerfile
  RUN apt-get update && \
      apt-get install -y package && \
      apt-get clean && \
      rm -rf /var/lib/apt/lists/*
  ```

### **6. Явное Задание Рабочего Каталога**

- **Установите рабочий каталог:** Это упрощает управление путями и улучшает читаемость Dockerfile.

  ```Dockerfile
  WORKDIR /app
  ```

### **7. Применение `.dockerignore`**

- **Исключение ненужных файлов:** Используйте файл `.dockerignore`, чтобы исключить ненужные файлы и каталоги из контекста сборки.

  ```plaintext
  node_modules
  *.log
  ```

### **8. Используйте Многоступенчатую Сборку**

- **Минимизация конечного образа:** Используйте многоступенчатую сборку для создания минимальных и чистых финальных образов.

  ```Dockerfile
  # Stage 1: Build
  FROM node:alpine AS builder
  WORKDIR /app
  COPY . .
  RUN npm install && npm run build

  # Stage 2: Production
  FROM nginx:alpine
  COPY --from=builder /app/dist /usr/share/nginx/html
  ```

### **Пример Улучшенного Dockerfile:**

```Dockerfile
# Stage 1: Build
FROM node:alpine AS builder
WORKDIR /app
COPY package.json package-lock.json ./
RUN npm install
COPY . .
RUN npm run build

# Stage 2: Production
FROM nginx:alpine
COPY --from=builder /app/build /usr/share/nginx/html
EXPOSE 80
CMD ["nginx", "-g", "daemon off;"]
```

Этот улучшенный Dockerfile демонстрирует использование многоступенчатой сборки, минимизацию слоев, установку рабочего каталога и очистку временных файлов.

[Само видео](https://youtu.be/6-xrwyDXGE4?si=4_lbK8sPKMpyKW1C)