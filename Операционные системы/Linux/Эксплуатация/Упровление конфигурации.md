## Введение 
Управление конфигурацией — это процесс учета изменений, вносимых в систему с целью сохранения ее целостности. Обычно используются инструменты и методы, способствующие автоматизации процесса и наблюдению состояния системы. Хотя эта концепция родилась не в ИТ-индустрии, термин стал широко использоваться для обозначения **управления конфигурацией сервера**.

В контексте серверов управление конфигурацией также часто называют _ИТ-автоматизацией_ или _оркестрацией сервера_. Оба термина освещают практические аспекты управления конфигурацией, а также возможность контроля нескольких систем с центрального сервера.

Из этого руководства вы узнаете о преимуществах использования инструментов управления конфигурацией для автоматизации настроек серверной инфраструктуры на примере системы управления [[ANSIBLE]]

## Преимущества использования инструментов управления конфигурацией

На рынке присутствует целый ряд инструментов управления конфигурацией разного уровня сложности и с разными архитектурами. Хотя все эти инструменты отличаются характеристиками и принципами работы, все они выполняют одну и ту же функцию: обеспечивают соответствие системы параметрам, заявленным в наборе _скриптов конфигурирования_.

Преимущества управления конфигурацией серверов состоят в способности определять вашу инфраструктуру как код. Это позволяет:

- использовать систему контроля версий для отслеживания любых изменений инфраструктуры
- повторно использовать скрипты конфигурирования для нескольких серверных сред, например для разработки, тестирования и производства
- предоставлять сотрудникам общий доступ к скриптам конфигурирования для упрощения сотрудничества в стандартизированной среде разработки
- упрощать процесс дублирования серверов для ускорения восстановления в случае сбоя системы

К тому же инструменты управления конфигурацией предлагают возможность централизованного контроля неограниченного числа серверов из одной точки. Это может значительно повысить производительность и укрепить целостность инфраструктуры.

## Обзор системы Ansible

Ansible — это современный инструмент управления конфигурацией, который упрощает настройку и удаленное администрирование серверов. Минималистичный дизайн инструмента обеспечивает простое и понятное использование.

Пользователи пишут скрипты конфигурирования Ansible в удобном формате сериализации данных [YAML](https://yaml.org/), который не привязывается к какому-либо языку программирования. Это позволяет пользователям интуитивно создавать сложные скрипты конфигурирования, в отличие от аналогичных инструментов такой же категории.

Ansible не требует установки специального программного обеспечения на узлах, где будет работать эта система. Контрольный механизм, настроенный в программном обеспечении Ansible, связывается с узлами через стандартные каналы SSH.

Как инструмент управления конфигурацией и система автоматизации Ansible имеет все функции, присутствующие в других инструментах этой же категории, но при этом данная система ориентируется на простоту использования и производительность:

### Идемпотентное поведение

Ansible отслеживает состояние ресурсов управляемых систем для недопущения повторения задач, которые выполнялись ранее. Если пакет уже установлен, система не будет пытаться установить его снова. Основной задачей является то, что при каждом исполнении система достигает (или сохраняет) желаемое состояние, даже если вы запускаете ее несколько раз. Это означает, что системе Ansible и другим инструментам управления конфигурацией присуще _идемпотентное поведение_. При запуске плейбука вы увидите статус каждой выполняемой задачи и указание, приводит ли выполненная задача к изменению системы.

### Поддержка переменных, условий и циклов

При написании скриптов автоматизации Ansible вы можете использовать переменные, условия и циклы, чтобы сделать процесс автоматизации более универсальным и эффективным.

### Системные сведения

Ansible собирает серию подробных данных об управляемых узлах, например сетевых интерфейсах и операционной системе, и обозначает эти данные как глобальные переменные, называемые _системными сведениями_. Сведения можно использовать внутри плейбуков, чтобы обеспечить универсальность и адаптивность автоматизации, работающей по-разному в зависимости от системы конфигурирования.

### Система шаблонов

Ansible использует систему шаблонов Jinja2 Python, разрешающую динамические выражения и доступ к переменным. Шаблоны можно использовать для облегчения настройки файлов и служб конфигурации. Например, вы можете использовать шаблон для настройки нового виртуального хоста в Apache, а также использовать такой же шаблон для нескольких установок сервера.

### Поддержка расширений и модулей

Ansible поставляется с сотнями встроенных модулей, упрощающих автоматизацию стандартных задач администрирования, таких как установка пакетов с помощью `apt` и синхронизация файлов через `rsync`, а также работа с популярными программами, например системами базы данных (MySQL, PostgreSQL, MongoDB и др.) и инструментами управления зависимостями (PHP ​​​`​​​composer​`​​, Ruby `​​​gem​​​​`​​, Node ​​​`​​​npm` и др.)​​​. Помимо этого существует ряд способов расширения системы Ansible. Это плагины и модули, которые необходимы для обеспечения пользовательских функций, не включенных по умолчанию.

Вы также можете использовать модули и плагины сторонних организаций, представленные на портале [Ansible Galaxy](https://galaxy.ansible.com/).

## Знакомство с концепциями Ansible

Давайте рассмотрим терминологию и концепции Ansible, чтобы познакомиться с терминами, которые будут употребляться в этой серии материалов.

### Узел управления

_Узел управления_ — это устройство с установленной и настроенной для подключения к вашему серверу системой Ansible. Вы можете использовать несколько узлов управления, а любая система, на которой возможен запуск Ansible, может быть настроена как узел управления, включая персональные компьютеры или ноутбуки на базе операционных систем Linux или Unix. На данный момент Ansible нельзя установить на хосте Windows, но вы можете обойти это ограничение, настроив виртуальную машину под управлением Linux и запустив на ней Ansible.

### Управляемые узлы
Системы, которыми вы управляете с помощью Ansible, называются _управляемыми узлами_. Для работы Ansible [необходимо](https://docs.ansible.com/ansible/latest/installation_guide/intro_installation.html#id11), чтобы управляемые узлы были доступны через каналы SSH и на них был установлен Python 2 (версия 2.6 или выше) или Python 3 (версия 3.5 или выше).

Ansible поддерживает различные операционные системы в качестве управляемых узлов, включая серверы Windows.

### Файлы инвентаризации

Файл _инвентаризации_ содержит список хостов, которыми вы будете управлять при помощи Ansible. Хотя Ansible обычно создает файл инвентаризации по умолчанию при установке, вы можете использовать файлы инвентаризации для каждого проекта отдельно. Это обеспечит лучшее разделение инфраструктуры и позволит избежать ошибочного выполнения команд или плейбуков не на том сервере. Статические файлы инвентаризации обычно создаются как файлы `.ini`, но вы также можете использовать динамически сгенерированные файлы, написанные на любом языке программирования, способном возвращать JSON.

### Задачи

В Ansible _задача_ — это отдельная часть работы, которую нужно выполнить на управляемом узле. Каждое действие, которое нужно выполнить, определяется как задача. Задачи можно выполнять как единичные действия через ситуативные команды или же включать их в плейбуки в качестве части скрипта автоматизации.

### Плейбук

_Плейбук_ состоит из списка заданных задач и нескольких директив, указывающих, какой хост является целью автоматизации, а также нужно ли использовать систему эскалации привилегий для выполнения этих задач. В плейбук также могут быть включены дополнительные разделы для определения переменных или включения файлов. Ansible выполняет задачи последовательно, а полноценное выполнение плейбука называется _плей_. Плейбуки записываются в формате YAML.

### Обработчики

_Обработчики_ используются для выполнения действий со службами, например при перезагрузке или остановке службы, которая активно работает на системе управляемого узла. Обработчики обычно запускаются с помощью задач, а их использование происходит в конце плея, после выполнения всех задач. В этом случае, если перезагрузку службы начинает более чем одна задача, служба запустится только один раз после выполнения всех команд. Хотя поведение обработчика по умолчанию более эффективно, также возможно принудительное немедленное выполнение обработчика, если этого требует задача.

### Роли

_Роль_ — это набор плейбуков и связанных файлов, организованных в предопределенную структуру, известную Ansible. Роли упрощают повторное использование плейбуков и превращают их в пакеты детализированной автоматизации с общим доступом для конкретных целей, таких как установка веб-сервера, среды PHP или настройка сервера MySQL.
