# üöÄ **ASan (AddressSanitizer) –≤ C**  

**ASan (AddressSanitizer)** ‚Äî —ç—Ç–æ –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç –¥–ª—è –≤—ã—è–≤–ª–µ–Ω–∏—è **–æ—à–∏–±–æ–∫ —Ä–∞–±–æ—Ç—ã —Å –ø–∞–º—è—Ç—å—é** –≤ C –∏ C++. –û–Ω –ø–æ–º–æ–≥–∞–µ—Ç –Ω–∞—Ö–æ–¥–∏—Ç—å:  

üî¥ **–¢–∏–ø–∏—á–Ω—ã–µ –æ—à–∏–±–∫–∏ –ø–∞–º—è—Ç–∏:**  
‚úÖ –í—ã—Ö–æ–¥ –∑–∞ –≥—Ä–∞–Ω–∏—Ü—ã –º–∞—Å—Å–∏–≤–∞ (**buffer overflow**)  
‚úÖ –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –æ—Å–≤–æ–±–æ–∂–¥—ë–Ω–Ω–æ–π –ø–∞–º—è—Ç–∏ (**use-after-free**)  
‚úÖ –î–æ—Å—Ç—É–ø –∫ –Ω–µ–∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω–æ–π –ø–∞–º—è—Ç–∏ (**use-after-scope**)  
‚úÖ –î–≤–æ–π–Ω–æ–µ –æ—Å–≤–æ–±–æ–∂–¥–µ–Ω–∏–µ –ø–∞–º—è—Ç–∏ (**double free**)  
‚úÖ –£—Ç–µ—á–∫–∏ –ø–∞–º—è—Ç–∏ (**memory leaks**)  

---  

## üìå **–ö–∞–∫ –≤–∫–ª—é—á–∏—Ç—å ASan?**  
–ö–æ–º–ø–∏–ª—è—Ç–æ—Ä—ã **GCC** –∏ **Clang** –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞—é—Ç ASan —Å —Ñ–ª–∞–≥–æ–º `-fsanitize=address`.  

### üîπ **–ö–æ–º–ø–∏–ª—è—Ü–∏—è —Å ASan**
```sh
gcc -g -fsanitize=address program.c -o program
```

### üîπ **–ó–∞–ø—É—Å–∫**
–ü—Ä–æ—Å—Ç–æ –∑–∞–ø—É—Å—Ç–∏ –ø—Ä–æ–≥—Ä–∞–º–º—É:  
```sh
./program
```
–ï—Å–ª–∏ –≤ –∫–æ–¥–µ –µ—Å—Ç—å –æ—à–∏–±–∫–∏ —Ä–∞–±–æ—Ç—ã —Å –ø–∞–º—è—Ç—å—é, ASan –∏—Ö –ø–æ–∫–∞–∂–µ—Ç.

---

## üõ† **–ü—Ä–∏–º–µ—Ä—ã –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è**  

### üîπ **1. –í—ã—Ö–æ–¥ –∑–∞ –≥—Ä–∞–Ω–∏—Ü—ã –º–∞—Å—Å–∏–≤–∞**  
```c
#include <stdio.h>

int main() {
    int arr[5];
    arr[10] = 42;  // ‚ùå –û—à–∏–±–∫–∞: –≤—ã—Ö–æ–¥ –∑–∞ –≥—Ä–∞–Ω–∏—Ü—ã –º–∞—Å—Å–∏–≤–∞
    return 0;
}
```
**–í—ã–≤–æ–¥ ASan:**  
```
==12345==ERROR: AddressSanitizer: heap-buffer-overflow on address 0x...
```
üí° **–ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ:** –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å **–ø—Ä–∞–≤–∏–ª—å–Ω—ã–µ –∏–Ω–¥–µ–∫—Å—ã** –∏ –ø—Ä–æ–≤–µ—Ä—è—Ç—å –≥—Ä–∞–Ω–∏—Ü—ã –º–∞—Å—Å–∏–≤–∞.

---

### üîπ **2. –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –æ—Å–≤–æ–±–æ–∂–¥—ë–Ω–Ω–æ–π –ø–∞–º—è—Ç–∏ (Use-after-free)**  
```c
#include <stdlib.h>

int main() {
    int *ptr = malloc(10 * sizeof(int));
    free(ptr);
    ptr[0] = 42;  // ‚ùå –û—à–∏–±–∫–∞: –¥–æ—Å—Ç—É–ø –∫ –æ—Å–≤–æ–±–æ–∂–¥—ë–Ω–Ω–æ–π –ø–∞–º—è—Ç–∏
    return 0;
}
```
**–í—ã–≤–æ–¥ ASan:**  
```
==12345==ERROR: AddressSanitizer: heap-use-after-free on address 0x...
```
üí° **–ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ:**  
–ü–æ—Å–ª–µ `free(ptr)` **–æ–±–Ω—É–ª—è–π —É–∫–∞–∑–∞—Ç–µ–ª—å**:  
```c
free(ptr);
ptr = NULL;
```

---

### üîπ **3. –î–≤–æ–π–Ω–æ–µ –æ—Å–≤–æ–±–æ–∂–¥–µ–Ω–∏–µ –ø–∞–º—è—Ç–∏ (Double free)**  
```c
#include <stdlib.h>

int main() {
    int *ptr = malloc(10 * sizeof(int));
    free(ptr);
    free(ptr);  // ‚ùå –û—à–∏–±–∫–∞: –¥–≤–æ–π–Ω–æ–µ –æ—Å–≤–æ–±–æ–∂–¥–µ–Ω–∏–µ –ø–∞–º—è—Ç–∏
    return 0;
}
```
**–í—ã–≤–æ–¥ ASan:**  
```
==12345==ERROR: AddressSanitizer: attempting double-free on 0x...
```
üí° **–ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ:**  
```c
free(ptr);
ptr = NULL;
```

---

### üîπ **4. –£—Ç–µ—á–∫–∏ –ø–∞–º—è—Ç–∏ (Memory Leaks)**  
ASan –º–æ–∂–Ω–æ –∑–∞–ø—É—Å—Ç–∏—Ç—å —Å –ø—Ä–æ–≤–µ—Ä–∫–æ–π —É—Ç–µ—á–µ–∫ –ø–∞–º—è—Ç–∏:  
```sh
ASAN_OPTIONS=detect_leaks=1 ./program
```

–ü—Ä–∏–º–µ—Ä –∫–æ–¥–∞ —Å —É—Ç–µ—á–∫–æ–π:  
```c
#include <stdlib.h>

int main() {
    int *ptr = malloc(10 * sizeof(int));
    return 0;  // ‚ùå –û—à–∏–±–∫–∞: –ø–∞–º—è—Ç—å –Ω–µ –æ—Å–≤–æ–±–æ–∂–¥–µ–Ω–∞
}
```
**–í—ã–≤–æ–¥ ASan:**  
```
==12345==ERROR: LeakSanitizer: detected memory leaks
```
üí° **–ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ:**  
```c
free(ptr);
```

---

## üéØ **–í—ã–≤–æ–¥**  
‚úÖ **ASan** ‚Äî –º–æ—â–Ω—ã–π –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç –¥–ª—è –ø–æ–∏—Å–∫–∞ –æ—à–∏–±–æ–∫ —Ä–∞–±–æ—Ç—ã —Å –ø–∞–º—è—Ç—å—é.  
‚úÖ –ü–æ–∑–≤–æ–ª—è–µ—Ç –Ω–∞—Ö–æ–¥–∏—Ç—å **–ø–µ—Ä–µ–ø–æ–ª–Ω–µ–Ω–∏—è –±—É—Ñ–µ—Ä–∞, —É—Ç–µ—á–∫–∏ –ø–∞–º—è—Ç–∏ –∏ use-after-free**.  
‚úÖ –†–∞–±–æ—Ç–∞–µ—Ç —Å **GCC –∏ Clang**.  